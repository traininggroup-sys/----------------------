<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¬Ø±ÙˆØ¨ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      body {
        margin: 0;
        font-family: "Cairo", sans-serif;
        background: linear-gradient(to right, #f5f5f5, #eaeaea);
        color: #333;
      }
      .start-screen,
      .module-select-screen {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #004e64;
        text-align: center;
        padding: 20px;
      }
      .start-screen h1 {
        font-size: 32px;
        color: #fff;
        margin-bottom: 10px;
      }
      .start-screen img {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 50%;
        border: 3px solid #fff;
        margin-bottom: 15px;
      }
      .start-btn {
        padding: 12px 30px;
        font-size: 18px;
        background: #0096c7;
        border: none;
        border-radius: 30px;
        color: #fff;
        cursor: pointer;
        margin: 5px;
      }
      .module-grid {
        display: none;
        padding: 40px 20px;
        background: #f0f8ff;
        text-align: center;
      }
      .module-grid h2 {
        margin-bottom: 20px;
      }
      .modules-wrap {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        justify-content: center;
      }
      .module-button {
        position: relative;
        background: #fff;
        border: 2px solid #ccc;
        border-radius: 15px;
        padding: 20px 18px;
        font-size: 18px;
        min-width: 220px;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .module-button:hover {
        transform: translateY(-5px);
        background: #d9fdd3;
      }
      .module-button i {
        display: block;
        font-size: 28px;
        margin-bottom: 8px;
      }
      .module-check {
        position: absolute;
        top: 10px;
        left: 12px;
        font-size: 18px;
        color: #22c55e;
        display: none;
      }
      .module-button.done .module-check {
        display: block;
      }
      main {
        display: none;
        padding: 20px;
        background: #fafafa;
      }
      .module {
        background: #fff;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        border: 1px solid #ccc;
      }
      .module h2 {
        margin-top: 0;
        color: #023e8a;
        border-bottom: 2px solid #ccc;
        padding-bottom: 10px;
        margin-bottom: 12px;
      }
      .model-title {
        background: #dbeafe;
        color: #1e3a8a;
        padding: 8px 12px;
        border-radius: 8px;
        margin: 14px 0 8px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 8px;
        justify-content: space-between;
        flex-wrap: wrap;
      }
      .open-btn {
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid #0096c7;
        background: #e6f7fb;
        cursor: pointer;
        font-size: 14px;
      }
      .task {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px dashed #ccc;
      }
      .task input[type="checkbox"] {
        transform: scale(1.2);
        accent-color: #00b4d8;
      }
      .task.completed {
        background: #d9fdd3;
        border-radius: 5px;
      }
      .motivator {
        margin-top: 18px;
        font-size: 18px;
        text-align: center;
        font-weight: bold;
        color: #2e7d32;
      }
      #admin-tools {
        display: none;
        margin: 16px 0;
        padding: 12px;
        border: 2px dashed #888;
        background: #eef;
        border-radius: 10px;
      }
      .admin-actions {
        margin-top: 10px;
      }
      .back-btn {
        background: #aaa;
        color: #fff;
        padding: 8px 15px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        margin-bottom: 12px;
      }
      .progress-container {
        width: 100%;
        background: #ddd;
        border-radius: 20px;
        height: 24px;
        margin: 10px 0 16px;
        overflow: hidden;
      }
      .progress-bar {
        height: 100%;
        width: 0%;
        background: #00b4d8;
        text-align: center;
        color: #fff;
        font-weight: bold;
        transition: width 0.4s ease;
      }
      .celebrate-banner {
        position: fixed;
        top: -80px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(90deg, #22c55e, #06b6d4, #3b82f6);
        color: #fff;
        padding: 14px 20px;
        border-radius: 999px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        z-index: 9999;
        white-space: nowrap;
        font-weight: 700;
      }
      .celebrate-banner.show {
        top: 20px;
        transition: top 0.5s ease;
      }
      .confetti {
        position: fixed;
        top: -10px;
        font-size: 22px;
        animation: fall linear forwards;
        z-index: 9998;
      }
      @keyframes fall {
        to {
          transform: translateY(110vh) rotate(720deg);
          opacity: 0.9;
        }
      }
      /* Leaderboard */
      #screen-lb {
        display: none;
        padding: 20px;
      }
      .lb-card {
        max-width: 900px;
        margin: 0 auto;
        background: #fff;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }
      table {
        width: 100%;
        border-collapse: collapse;
        text-align: center;
      }
      th,
      td {
        padding: 10px;
        border-bottom: 1px solid #ccc;
      }
      th {
        background: #f0f8ff;
      }
    </style>
  </head>
  <body>
    <!-- Start Screen -->
    <section class="start-screen" id="start-screen">
      <img src="5776125144014639249.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ø±ÙˆØ¨" />
      <h1>Ø¬Ø±ÙˆØ¨ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</h1>
      <input
        id="nameInput"
        placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ"
        style="padding: 10px; margin: 10px; border-radius: 10px; border: none"
      />
      <div>
        <button class="start-btn" onclick="startApp()">
          Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¢Ù†
        </button>
        <button class="start-btn" onclick="openLeaderboard()">
          Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ğŸ†
        </button>
      </div>
    </section>

    <!-- Module Grid -->
    <section class="module-grid" id="module-grid">
      <h2>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙˆØ± Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</h2>
      <div class="modules-wrap" id="modules-container"></div>
      <button class="start-btn" onclick="backToStart()">
        Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      </button>
    </section>

    <!-- Main Content -->
    <main id="main">
      <button class="back-btn" onclick="backToModules()">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar">0%</div>
      </div>
      <div id="admin-tools">
        <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù…Ø´Ø±ÙØ© (Ù†Ø¬Ù„Ø§)</h3>
        <select id="module-select"></select>
        <div class="admin-actions">
          <button onclick="addModel()">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ±</button>
          <button onclick="confirmRemoveModel()">ğŸ—‘ï¸ Ø­Ø°Ù Ø¢Ø®Ø± Ø¹Ù†ØµØ±</button>
        </div>
      </div>
      <div id="content"></div>
      <div class="motivator" id="motivator"></div>
    </main>

    <!-- Leaderboard -->
    <section id="screen-lb">
      <div class="lb-card">
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ğŸ†</h2>
        <table>
          <thead>
            <tr>
              <th>Ø§Ù„ØªØ±ØªÙŠØ¨</th>
              <th>Ø§Ù„Ø§Ø³Ù…</th>
              <th>Ø§Ù„ØªÙ‚Ø¯Ù…</th>
              <th>Ø£ÙˆØ³Ù…Ø©</th>
              <th>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</th>
            </tr>
          </thead>
          <tbody id="lbBody"></tbody>
        </table>
        <button class="start-btn" onclick="closeLeaderboard()">Ø±Ø¬ÙˆØ¹</button>
      </div>
    </section>

    <!-- Celebration Banner -->
    <div id="celebrateBanner" class="celebrate-banner">
      ğŸ† Ø¨Ø±Ø§ÙÙˆÙˆ! Ø¥Ù†Ø¬Ø§Ø² Ø±Ù‡ÙŠØ¨!
    </div>

    <script>
      const adminName = "Ù†Ø¬Ù„Ø§";
      const tasks = ["Ù…Ø°Ø§ÙƒØ±Ø©/Ù…Ø´Ø§Ù‡Ø¯Ø©", "Ø­Ù„ Ø§Ù„Ø§Ø³ØªÙØªØ§Ø¡Ø§Øª", "Ø­Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨ÙˆÙ‚Øª"];
      let username = "",
        selectedSection = "",
        userKey = "",
        userData = {},
        completedSections = {};
      const moduleData = {
        "ğŸ“˜ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©": { type: "models", count: 2, icon: "fa-lightbulb" },
        "ğŸ’» Ø­Ø§Ø³Ø¨": {
          type: "list",
          icon: "fa-computer",
          items: [
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 1", url: "https://youtu.be/aTGmvmeDJf8" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 2", url: "https://youtu.be/9tye0LUQfYI" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 3", url: "https://youtu.be/N3Z5p65om0o" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 4", url: "https://youtu.be/_HwWcpqTdHI" },
          ],
        },
        "ğŸ—£ï¸ Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ": { type: "models", count: 16, icon: "fa-language" },
        "ğŸ“™ Ø¹Ø±Ø¨ÙŠ": { type: "models", count: 17, icon: "fa-book" },
      };

      function startApp() {
        const name = document.getElementById("nameInput").value.trim();
        if (!name) return;
        username = name;
        userKey = `centralUser_${username}`;
        userData = JSON.parse(localStorage.getItem(userKey) || "{}");
        completedSections = JSON.parse(
          localStorage.getItem(`${userKey}_completedSections`) || "{}"
        );
        document.getElementById("start-screen").style.display = "none";
        document.getElementById("module-grid").style.display = "block";
        renderModuleButtons();
      }

      function renderModuleButtons() {
        const wrap = document.getElementById("modules-container");
        wrap.innerHTML = "";
        for (const section in moduleData) {
          const btn = document.createElement("button");
          btn.className =
            "module-button" + (completedSections[section] ? " done" : "");
          btn.innerHTML = `<i class='fas fa-book-open'></i>${section}<span class="module-check">âœ…</span>`;
          btn.onclick = () => openModule(section);
          wrap.appendChild(btn);
        }
      }

      function openModule(section) {
        selectedSection = section;
        document.getElementById("module-grid").style.display = "none";
        document.getElementById("main").style.display = "block";
        if (username === adminName) {
          document.getElementById("admin-tools").style.display = "block";
          const sel = document.getElementById("module-select");
          sel.innerHTML = "";
          for (const s in moduleData) {
            const opt = document.createElement("option");
            opt.value = s;
            opt.textContent = s;
            if (s === section) opt.selected = true;
            sel.appendChild(opt);
          }
        }
        generateModules(section);
        updateProgressBar();
      }

      function generateModules(section) {
        const container = document.getElementById("content");
        container.innerHTML = "";
        const data = moduleData[section];
        const moduleDiv = document.createElement("div");
        moduleDiv.className = "module";
        const title = document.createElement("h2");
        title.textContent = section;
        moduleDiv.appendChild(title);
        if (data.type === "models") {
          for (let i = 1; i <= data.count; i++) {
            addBlock(moduleDiv, section, `model_${i}`, `ğŸ“„ Ù†Ù…ÙˆØ°Ø¬ ${i}`);
          }
        } else if (data.type === "list") {
          data.items.forEach((item, idx) => {
            addBlock(
              moduleDiv,
              section,
              `item_${idx + 1}`,
              (item.url ? "ğŸ¬ " : "ğŸ“„ ") + item.title,
              item.url
            );
          });
        }
        container.appendChild(moduleDiv);
        showMotivation();
      }

      function addBlock(parent, section, id, titleText, url = "") {
        const header = document.createElement("div");
        header.className = "model-title";
        const left = document.createElement("span");
        left.textContent = titleText;
        header.appendChild(left);
        if (url) {
          const openBtn = document.createElement("button");
          openBtn.className = "open-btn";
          openBtn.textContent = "ÙØªØ­ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ";
          openBtn.onclick = () => window.open(url, "_blank");
          header.appendChild(openBtn);
        }
        parent.appendChild(header);
        tasks.forEach((task, idx) => {
          const taskDiv = document.createElement("div");
          taskDiv.className = "task";
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          const taskKey = `${section}_${id}_${idx}`;
          if (userData[taskKey]) {
            checkbox.checked = true;
            taskDiv.classList.add("completed");
          }
          checkbox.addEventListener("change", () => {
            userData[taskKey] = checkbox.checked;
            localStorage.setItem(userKey, JSON.stringify(userData));
            taskDiv.classList.toggle("completed", checkbox.checked);
            updateProgressBar();
            checkSectionCompletion(section);
          });
          const label = document.createElement("label");
          label.textContent = task;
          taskDiv.appendChild(label);
          taskDiv.appendChild(checkbox);
          parent.appendChild(taskDiv);
        });
      }

      function updateProgressBar() {
        const bar = document.getElementById("progress-bar");
        let totalTasks = 0,
          completed = 0;
        const data = moduleData[selectedSection];
        if (data.type === "models") totalTasks = data.count * tasks.length;
        else totalTasks = data.items.length * tasks.length;
        for (const [k, v] of Object.entries(userData)) {
          if (v && k.startsWith(selectedSection + "_")) completed++;
        }
        const pct = totalTasks ? Math.round((completed / totalTasks) * 100) : 0;
        bar.style.width = pct + "%";
        bar.textContent = pct + "%";
      }

      function showMotivation() {
        const done = Object.values(userData).filter(Boolean).length;
        const motivator = document.getElementById("motivator");
        motivator.textContent =
          done === 0
            ? "Ø§Ø¨Ø¯Ø£ Ø£ÙˆÙ„ Ø®Ø·ÙˆØ© ÙˆÙ‡ØªÙ„Ø§Ù‚ÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø³Ù‡Ù„! ğŸ’ª"
            : done % 10 === 0
            ? `ğŸ‘ Ù…Ù…ØªØ§Ø² ÙŠØ§ ${username}! Ø®Ù„ØµØª ${done} Ø®Ø·ÙˆØ©! Ø§Ø³ØªÙ…Ø±!`
            : done > 50
            ? `ğŸ”¥ Ø§Ù†Øª Ø¨Ø·Ù„ Ø¨Ø¬Ø¯ ÙŠØ§ ${username}ØŒ Ù‚Ø±Ø¨Øª ØªØ®Ù„Øµ ÙƒÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰!`
            : "";
      }

      function checkSectionCompletion(section) {
        const data = moduleData[section];
        let totalTasks =
          data.type === "models"
            ? data.count * tasks.length
            : data.items.length * tasks.length;
        let completed = 0;
        for (const [k, v] of Object.entries(userData)) {
          if (v && k.startsWith(section + "_")) completed++;
        }
        if (
          totalTasks > 0 &&
          completed >= totalTasks &&
          !completedSections[section]
        ) {
          completedSections[section] = true;
          localStorage.setItem(
            `${userKey}_completedSections`,
            JSON.stringify(completedSections)
          );
          celebrate(section);
        }
      }

      function celebrate(section) {
        showBanner(`ğŸ† Ø¨Ø±Ø§ÙÙˆÙˆ ÙŠØ§ ${username}! Ø®Ù„ØµØª Ù…Ø­ÙˆØ± "${section}" ÙƒØ§Ù…Ù„!`);
        launchConfetti(120, 5000);
      }
      function showBanner(text) {
        const b = document.getElementById("celebrateBanner");
        b.textContent = text;
        b.classList.add("show");
        setTimeout(() => b.classList.remove("show"), 5000);
      }
      function launchConfetti(count = 100, duration = 4000) {
        const emojis = ["ğŸ‰", "ğŸˆ", "âœ¨", "ğŸŠ", "â­"];
        const W = window.innerWidth;
        for (let i = 0; i < count; i++) {
          const span = document.createElement("span");
          span.className = "confetti";
          span.textContent = emojis[Math.floor(Math.random() * emojis.length)];
          span.style.left = Math.random() * W + "px";
          span.style.animationDuration = 2 + Math.random() * 3 + "s";
          span.style.transform = `translateY(-10px) rotate(${
            Math.random() * 360
          }deg)`;
          document.body.appendChild(span);
          setTimeout(() => span.remove(), duration);
        }
      }

      function backToModules() {
        document.getElementById("main").style.display = "none";
        document.getElementById("module-grid").style.display = "block";
        renderModuleButtons();
      }
      function backToStart() {
        document.getElementById("module-grid").style.display = "none";
        document.getElementById("start-screen").style.display = "flex";
      }
      function addModel() {
        const section = document.getElementById("module-select").value;
        const data = moduleData[section];
        if (data.type === "models") data.count++;
        else
          data.items.push({
            title: `Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ ${data.items.length + 1}`,
            url: "",
          });
        generateModules(section);
        updateProgressBar();
      }
      function confirmRemoveModel() {
        const section = document.getElementById("module-select").value;
        const data = moduleData[section];
        if (data.type === "models" && data.count > 1) data.count--;
        else if (data.type === "list" && data.items.length > 1)
          data.items.pop();
        generateModules(section);
        updateProgressBar();
      }

      // ===== Leaderboard =====
      function openLeaderboard() {
        document.getElementById("start-screen").style.display = "none";
        document.getElementById("screen-lb").style.display = "block";
        const lbBody = document.getElementById("lbBody");
        lbBody.innerHTML = "";
        for (const key in localStorage) {
          if (key.startsWith("centralUser_")) {
            const user = key.replace("centralUser_", "");
            const data = JSON.parse(localStorage.getItem(key) || "{}");
            let done = Object.values(data).filter(Boolean).length;
            let medals = "";
            if (done > 50) medals = "ğŸ…";
            else if (done > 20) medals = "ğŸ–ï¸";
            let updated = new Date().toLocaleDateString();
            lbBody.innerHTML += `<tr><td>â€”</td><td>${user}</td><td>${done}</td><td>${medals}</td><td>${updated}</td></tr>`;
          }
        }
      }
      function closeLeaderboard() {
        document.getElementById("screen-lb").style.display = "none";
        document.getElementById("start-screen").style.display = "flex";
      }
    </script>
  </body>
</html>
