<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¬Ø±ÙˆØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ¨</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="icon" type="image/png" href="/path/to/favicon.png" />

    <style>
      /* ================== General ================== */
      body {
        font-family: "Cairo", sans-serif;
        margin: 0;
        padding: 0;
        background: linear-gradient(to right, #f0f0f0, #e0f7fa);
        overflow-x: hidden;
      }
      h1,
      h2,
      h3 {
        margin: 0 0 10px 0;
      }

      /* ================== Screens ================== */
      #start-screen,
      #module-grid,
      #main,
      #screen-lb,
      #admin-panel {
        display: none;
        padding: 20px;
        min-height: 100vh;
        box-sizing: border-box;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
      }
      .section-title {
        font-family: "Cairo", sans-serif;
        font-size: 30px;
        font-weight: bold;
        color: #000000; /* Ù„ÙˆÙ† Ø£Ø²Ø±Ù‚ Ù…Ù…ÙŠØ² */
        text-align: center;
        margin: 20px 0;
        position: relative;
      }

      .section-title::after {
        content: "";
        display: block;
        width: 60px;
        height: 4px;
        background: linear-gradient(90deg, #fbc02d, #4caf50);
        margin: 8px auto 0;
        border-radius: 2px;
      }

      #start-screen {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }
      input {
        padding: 10px;
        margin: 6px;
        width: 15px;
        font-size: 16px;
        border-radius: 5px;
        border: 1px solid #ccc;
      }
      .login-input {
        padding: 10px;
        margin: 6px;
        width: 200px;
        font-size: 16px;
        border-radius: 5px;
        border: 1px solid #ccc;
      }
      button {
        padding: 10px 20px;
        margin: 10px;
        cursor: pointer;
        font-size: 16px;
        border-radius: 10px;
        border: none;
        background: linear-gradient(90deg, #6f3f75, #0629d4);
        color: white;
        transition: 0.3s;
        font-weight: 700;
      }
      button:hover {
        opacity: 0.9;
      }

      /* ================== Logo and Title ================== */
      #logo-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 20px;
      }
      #logo {
        font-size: 50px;
        color: gold;
      }
      #group-title {
        font-size: 24px;
        font-weight: bold;
        margin-top: 10px;
      }
      #group-description {
        font-size: 18px;
        color: #555;
        text-align: center;
      }

      /* ================== Module Grid ================== */
      #modules-container {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        justify-content: center;
        max-height: 70vh;
        overflow-y: auto;
        padding: 10px;
      }
      .module-button {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 220px;
        padding: 10px;
        font-size: 16px;
        cursor: pointer;
        border-radius: 8px;
        background: #fff;
        transition: 0.3s;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
      }
      .module-button.done {
        background: #a0ffa0;
      }
      .module-button i {
        margin-left: 10px;
      }

      /* ================== Main Modules ================== */
      #content {
        display: flex;
        flex-direction: column;
        gap: 15px;
        max-height: 65vh;
        overflow-y: auto;
        padding: 10px;
        width: 100%;
      }
      .module {
        padding: 15px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        animation: fadein 0.5s;
      }
      .task {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 8px;
        padding: 5px 10px;
        border-radius: 5px;
        transition: 0.3s;
      }
      .task.completed {
        background: #e0ffe0;
      }

      /* ===== CSS Ù„Ù„Ø¬Ø¯ÙˆÙ„ ÙˆØ´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… ===== */
      #leaderboard {
        width: 100%;
        border-collapse: collapse;
        font-family: Cairo, sans-serif;
      }
      #leaderboard th,
      #leaderboard td {
        padding: 8px 12px;
        text-align: center;
        border-bottom: 1px solid #ddd;
      }

      .progress-bar-container {
        width: 100%;
        background-color: #eee;
        border-radius: 5px;
        height: 12px;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #fbc02d, #4caf50);
        border-radius: 5px;
        transition: width 0.8s ease-in-out;
      }
      #progress-container {
        width: 100%;
        background-color: #eee;
        border-radius: 10px;
        overflow: hidden;
      }

      #progress-bar {
        width: 0%;
        height: 25px;
        background-color: #4caf50;
        color: white;
        text-align: center;
        line-height: 25px;
        border-radius: 10px 0 0 10px;
        transition: width 0.3s ease;
      }

      .badge {
        font-size: 18px;
        text-shadow: 1px 1px 3px #333;
      }

      .top-1 td {
        font-weight: bold;
        color: #d32f2f;
      }
      .top-2 td {
        font-weight: bold;
        color: #1976d2;
      }
      .top-3 td {
        font-weight: bold;
        color: #f57c00;
      }

      /* ================== Banner ================== */
      #celebrateBanner {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 15px 25px;
        font-size: 18px;
        font-weight: bold;
        color: white;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        z-index: 9999;
        display: none;
        background: #f57c00;
        width: 230px;
      }
      #celebrateBanner.show {
        display: block;
        animation: fadeInOut 5s ease;
      }

      /* ================== Confetti ================== */
      .confetti {
        position: fixed;
        font-size: 24px;
        pointer-events: none;
        animation-name: confettiAnim;
      }
      @keyframes confettiAnim {
        0% {
          top: 0;
        }
        100% {
          top: 100vh;
        }
      }
      @keyframes fadein {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes fadeInOut {
        0% {
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        90% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      /* ================== Leaderboard ================== */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }
      td,
      th {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: center;
      }
      .lb-row {
        opacity: 0;
        transform: translateY(20px);
        animation: fadeSlide 0.6s forwards;
      }
      .lb-row:nth-child(1) {
        animation-delay: 0.1s;
      }
      .lb-row:nth-child(2) {
        animation-delay: 0.2s;
      }
      .lb-row:nth-child(3) {
        animation-delay: 0.3s;
      }
      .lb-row:nth-child(4) {
        animation-delay: 0.4s;
      }
      .lb-row:nth-child(5) {
        animation-delay: 0.5s;
      }
      @keyframes fadeSlide {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .top-1 td {
        font-weight: bold;
        color: #d32f2f;
        animation: glow 1.5s infinite alternate;
      }
      .top-2 td {
        font-weight: bold;
        color: #1976d2;
      }
      .top-3 td {
        font-weight: bold;
        color: #f57c00;
      }

      @keyframes glow {
        from {
          text-shadow: 0 0 5px #ff0000;
        }
        to {
          text-shadow: 0 0 20px #ff5252;
        }
      }
      .medal {
        display: inline-block;
        animation: bounce 1s infinite;
      }
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-5px);
        }
      }

      /* ================== Fixed Back Buttons ================== */
      .fixed-back {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 999;
      }

      /* ================== uttons ================== */

      .module-header {
        display: flex;
        justify-content: space-between; /* ÙŠØ®Ù„ÙŠ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø´Ù…Ø§Ù„ ÙˆØ§Ù„Ø²Ø±Ø§Ø± ÙŠÙ…ÙŠÙ† */
        align-items: center;
        background: #f3f4f6;
        padding: 1px 5px;
        border-radius: 8px;
        margin-bottom: 10px;
      }

      .module-header h2 {
        margin: 0;
        font-size: 18px;
        color: #333;
      }

      .button-open-model {
        padding: 6px 14px;
        background-color: #06b6d4;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-size: 14px;
        transition: background-color 0.3s;
      }

      .button-open-model i {
        margin-left: 6px;
      }

      .button-open-model:hover {
        background-color: #0e7490;
      }
      button.module-btn {
        padding: 10px 13px;
        margin: -1px;
        cursor: pointer;
        font-size: 16px;
        border-radius: 9px;
        border: none;
        background: linear-gradient(90deg, #6f3f75, #0629d4);
        color: white;
        transition: 0.3s;
        font-weight: 700;
      }
      .section-heading {
        text-align: center;
        font-size: 32px;
        margin: 20px 0;
        color: #121212;
        font-weight: bold;
      }
      .disabled-task {
        opacity: 0.5; /* Ø¨Ø§Ù‡Øª Ø´ÙˆÙŠØ© */
        cursor: not-allowed; /* Ù…Ø¤Ø´Ø± Ø§Ù„ÙØ£Ø±Ø© ÙŠØ´ÙŠØ± Ø¥Ù†Ù‡ Ù…Ù‚ÙÙˆÙ„ */
      }

      /* ================== Admin Panel ================== */
      #admin-panel {
        background-color: #f8f9fa;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        width: 90%;
        max-width: 800px;
        margin: 0 auto;
      }

      .admin-form {
        width: 100%;
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .admin-form-group {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .admin-form label {
        font-weight: bold;
        font-size: 16px;
        color: #333;
      }

      .admin-form input,
      .admin-form select {
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ddd;
        font-size: 16px;
        width: 100%;
      }

      .admin-btn {
        padding: 12px 25px;
        font-size: 16px;
        font-weight: bold;
      }

      .admin-btn-primary {
        background: linear-gradient(90deg, #4a148c, #7b1fa2);
      }

      .admin-btn-secondary {
        background: linear-gradient(90deg, #37474f, #546e7a);
      }

      .admin-notification {
        background-color: #e8f5e9;
        border-left: 5px solid #4caf50;
        padding: 15px;
        margin: 20px 0;
        border-radius: 5px;
        font-weight: bold;
        display: none;
      }
    </style>
  </head>

  <body>
    <div id="celebrateBanner"></div>

    <!-- ===== Start Screen ===== -->
    <div id="start-screen">
      <div id="logo-container">
        <div id="logo">ğŸ…</div>
        <div id="group-title">Ø¬Ø±ÙˆØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ¨</div>
        <div id="group-description">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ø¬Ø±ÙˆØ¨ Ø§Ù„ØªØ¯Ø±ÙŠØ¨</div>
      </div>
      <input
        type="text"
        id="nameInput"
        class="login-input"
        placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ"
      />
      <input
        type="password"
        id="passwordInput"
        class="login-input"
        placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
      />
      <button onclick="startApp()">Ø§Ø¨Ø¯Ø£</button>
      <button id="btnLeaderboard">Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</button>
    </div>

    <!-- ===== Module Grid ===== -->
    <div id="module-grid">
      <h2 class="section-title">Ø§Ù„Ù…Ø­Ø§ÙˆØ±</h2>
      <div id="modules-container"></div>

      <button class="fixed-back" onclick="backToStart()">Ø±Ø¬ÙˆØ¹</button>
    </div>

    <!-- ===== Main Module ===== -->
    <div id="main">
      <h2 id="section-title"></h2>
      <div id="progress-container"><div id="progress-bar">0%</div></div>
      <div id="content"></div>
      <button class="fixed-back" onclick="backToModules()">Ø±Ø¬ÙˆØ¹</button>
    </div>

    <!-- ===== Leaderboard ===== -->
    <div id="screen-lb" style="display: none">
      <table id="leaderboard">
        <thead>
          <tr>
            <th>Ø§Ù„ØªØ±ØªÙŠØ¨</th>
            <th>Ø§Ù„Ø§Ø³Ù…</th>
            <th>Ø§Ù„ØªÙ‚Ø¯Ù…</th>
            <th>Ø§Ù„Ø£ÙˆØ³Ù…Ø©</th>
          </tr>
        </thead>
        <tbody id="lbBody"></tbody>
      </table>

      <button class="fixed-back" onclick="closeLeaderboard()">Ø±Ø¬ÙˆØ¹</button>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
      import {
        getFirestore,
        doc,
        getDoc,
        setDoc,
        collection,
        getDocs,
        updateDoc,
        arrayUnion,
      } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyD8OVH4XP4AOCCRcEjp-BWLXuIBDzEbdcU",
        authDomain: "motivationapp-a3890.firebaseapp.com",
        projectId: "motivationapp-a3890",
        storageBucket: "motivationapp-a3890.appspot.com",
        messagingSenderId: "231712261826",
        appId: "1:231712261826:web:6285e51747ca8bb6b21d5b",
        measurementId: "G-WGY8RZFJGG",
      };
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      let username = "",
        password = "",
        selectedSection = "";
      const tasks = [
        "Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬",
        "Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ",
        "Ø­Ù„ Ø§Ù„Ø§Ø³ØªÙØªØ§Ø¡Ø§Øª",
        "Ø­Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨ÙˆÙ‚Øª",
      ];

      const moduleData = {
        " Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©": { type: "models", icon: "ğŸ’¡", count: 20 },
        " Ø­Ø§Ø³Ø¨": { type: "models", icon: "ğŸ’»", count: 22 }, // Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª + Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
        " Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ": { type: "models", icon: "ğŸ—£ï¸", count: 22 },
        " Ø¹Ø±Ø¨ÙŠ": { type: "models", icon: "ğŸ“˜", count: 19 },
      };

      // ======================= Login =======================
      window.startApp = async function () {
        const nameInput = document.getElementById("nameInput").value.trim();
        const passInput = document.getElementById("passwordInput").value.trim();
        if (!nameInput || !passInput)
          return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ†
        const userRef = doc(db, "users", nameInput);
        const snap = await getDoc(userRef);

        if (snap.exists()) {
          const data = snap.data();
          if (data.password !== passInput)
            return alert("Ø§Ù„Ø§Ø³Ù… Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");
        } else {
          await setDoc(userRef, {
            name: nameInput,
            password: passInput,
            completedTasks: {},
            completedSections: {},
          });
        }

        username = nameInput;
        password = passInput;

        document.getElementById("start-screen").style.display = "none";
        document.getElementById("module-grid").style.display = "flex";
        document.getElementById("admin-buttons").style.display = "none";
        renderModuleButtons();
      };

      // ======================= Render Modules =======================
      async function renderModuleButtons() {
        const wrap = document.getElementById("modules-container");
        wrap.innerHTML = "";
        const userData = await getUserData();
        for (const section in moduleData) {
          const done = userData.completedSections?.[section] || false;
          const btn = document.createElement("button");
          btn.className = "module-button" + (done ? " done" : "");
          btn.innerHTML = `
        <span style="font-size:24px;margin-left:10px;">${moduleData[section].icon}</span>
        <span style="font-size:18px;font-weight:700;color:#222;">${section}</span>
        <span class="module-check">âœ…</span>
      `;
          btn.onclick = () => openModule(section);
          wrap.appendChild(btn);
        }
      }

      window.openModule = async function (section) {
        selectedSection = section;
        document.getElementById("module-grid").style.display = "none";
        document.getElementById("main").style.display = "flex";

        generateModules(section);
        updateProgressBar();
      };
      /*Ø§Ù„Ù…Ø­Ø§ÙˆÙˆÙˆÙˆØ±*/
      const linksData = {
        " Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©": [
          {
            title: "Ù…Ø­Ø§ÙˆØ± ÙˆÙƒØ¨Ø§Ø±ÙŠ",
            file: "https://t.me/c/2299629125/2/34633?single",
          },
          {
            title: "Ø§Ù‡Ù… Ø§Ù„Ù…Ù†Ø¸Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©",
            file: "https://t.me/c/2299629125/2/35213",
          },
          {
            title: "Ø§Ù‚Ø§Ù„ÙŠÙ… Ù…ØµØ± Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©",
            file: "https://t.me/c/2299629125/2/35024",
          },
          { title: "Ø­ÙƒØ§Ù… Ù…ØµØ±", file: "https://t.me/c/2299629125/2/35003" },
          { title: "ØµÙˆØ§Ù…Ø¹ Ù…ØµØ±", file: "https://t.me/c/2299629125/2/34792" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 1", file: "https://t.me/c/2299629125/2/30375" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 2", file: "https://t.me/c/2299629125/2/30396" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 3", file: "https://t.me/c/2299629125/2/30428" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 4", file: "https://t.me/c/2299629125/2/30449" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 5", file: "https://t.me/c/2299629125/2/30470" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 6", file: "https://t.me/c/2299629125/2/30492" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 7", file: "https://t.me/c/2299629125/2/30513" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 8", file: "https://t.me/c/2299629125/2/30540" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 9", file: "https://t.me/c/2299629125/2/30560" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 10", file: "https://t.me/c/2299629125/2/30581" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 11", file: "https://t.me/c/2299629125/2/31259" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 12", file: "https://t.me/c/2299629125/2/31280" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 13", file: "https://t.me/c/2299629125/2/31302" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 14", file: "https://t.me/c/2299629125/2/31327" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 15", file: "https://t.me/c/2299629125/2/31348" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 16", file: "https://t.me/c/2299629125/2/31370" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 17", file: "https://t.me/c/2299629125/2/31393" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 18", file: "https://t.me/c/2299629125/2/31415" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 19", file: "https://t.me/c/2299629125/2/31437" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 20", file: "https://t.me/c/2299629125/2/31460" },
        ],
        " Ø­Ø§Ø³Ø¨": [
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 1",
            video: "https://youtu.be/aTGmvmeDJf8",
            file: "https://t.me/c/2299629125/4/27632",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 2",
            video: "https://youtu.be/9tye0LUQfYI",
            file: "https://t.me/c/2299629125/4/27633",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 3",
            video: "https://youtu.be/N3Z5p65om0o",
            file: "https://t.me/c/2299629125/4/27634",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 4",
            video: "https://youtu.be/_HwWcpqTdHI",
            file: "https://t.me/c/2299629125/4/27786?single",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 6",
            video: "https://youtu.be/1DbFtQZpsW0",
            file: "https://t.me/c/2299629125/4/27787?single",
          },
          {
            title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ Excel",
            video: "https://youtu.be/JzsTom7tTx8",
            file: "https://t.me/c/2299629125/4/33248?single",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 7",
            video: "https://youtu.be/jUBGca5qRnM",
            file: "https://t.me/c/2299629125/4/27788?single",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 8",
            video: "https://youtu.be/q3Zz99bThyQ",
            file: "https://t.me/c/2299629125/4/27964?single",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 9",
            video: "https://youtu.be/_Ea_z_Ft4bs",
            file: "https://t.me/c/2299629125/4/27964?single",
          },
          {
            title: "Ø´Ø±Ø­ Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù„ÙŠ Excel",
            video: "https://youtu.be/qn5rs-4mFJo",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 10",
            video: "https://youtu.be/hRAdE691Mg4",
            file: "https://t.me/c/2299629125/4/28036",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 11",
            video: "https://youtu.be/LNlw1VhnDWM",
            file: "https://t.me/c/2299629125/4/28235",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 12",
            video: "https://youtu.be/mdgj-gbvOIg",
            file: "https://t.me/c/2299629125/4/28236",
          },
          {
            title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ Excel",
            video: "https://youtu.be/GI8RU0FXXO4",
            file: "https://t.me/c/2299629125/4/33248?single",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 13",
            video: "https://youtu.be/sTGkL7xYwCE",
            file: "https://t.me/c/2299629125/4/31134",
          },
          {
            title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ Access",
            video: "https://youtu.be/SOFszLmW_X8",
            file: "https://t.me/c/2299629125/4/28417",
          },
          {
            title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ PowerPoint Ø¬Ø²Ø¡ Ù¡",
            video: "https://youtu.be/53ydwEIFrog",
          },
          {
            title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ PowerPoint Ø¬Ø²Ø¡ Ù¢",
            video: "https://youtu.be/yCvhQdWY0ac",
            file: "https://t.me/c/2299629125/4/28565",
          },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 14",
            video: "https://youtu.be/8ypgm2RJ804",
            file: "https://t.me/c/2299629125/4/33241",
          },
          { title: "Ø£Ù‡Ù… Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª", video: "https://youtu.be/lhjovAocMMw" },
          { title: "Ø§Ø³Ø¦Ù„Ø© Ù…Ø¬Ù…Ø¹Ø©", video: "https://youtu.be/BgYzh47Icm0" },
          {
            title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 15",
            video: "https://youtu.be/9AY9POUJYLc",
            file: "https://t.me/c/2299629125/4/29232?single",
          },
          {
            title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„Ù„Ø­Ø§Ø³Ø¨ Ø¬Ø²Ø¡ Ù¡",
            video: "https://youtu.be/2V0fQEpAeiM",
          },
          {
            title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„Ù„Ø­Ø§Ø³Ø¨ Ø¬Ø²Ø¡ Ù¢",
            video: "https://youtu.be/W1Qcsu6hy4U",
          },
          /* {
            title: "Ø´Ø±Ø­ Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ ÙÙŠ Excel",
            video: "https://youtu.be/-uIb6ZpFEi4",
          },
          {
            title: "Ø´Ø±Ø­ Ø³Ø¤Ø§Ù„ Ù„Ø¹Ù…Ù„ ØªØ®Ø·ÙŠØ· Ù‡ÙŠÙƒÙ„ÙŠ Ù†Ø®ØªØ§Ø± Ø¥ÙŠÙ‡",
            video: "https://youtu.be/Odgj-G4pHU",
          },*/
          // Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 1",
            video: "https://youtu.be/evZEGltYYXs",
            file: "https://t.me/c/2299629125/4/28648",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 2",
            video: "https://youtu.be/U_jAqbzbjRA",
            file: "https://t.me/c/2299629125/4/28765",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 3",
            video: "https://youtu.be/IkT_6INmCyY",
            file: "https://t.me/c/2299629125/4/28767",
          },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 4", file: "https://t.me/c/2299629125/4/28873" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 5", file: "https://t.me/c/2299629125/4/28960" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 6", file: "https://t.me/c/2299629125/4/28961" },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 7",
            file: "https://t.me/c/2299629125/4/33673?single",
          },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 8", file: "https://t.me/c/2299629125/4/29927" },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 9",
            video: "https://youtu.be/VtOe_dx5qn8",
            file: "https://t.me/c/2299629125/4/29958",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 10",
            file: "https://t.me/c/2299629125/4/27223?single",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 11",
            file: "https://t.me/c/2299629125/4/27224?single",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 12",
            file: "https://t.me/c/2299629125/4/27873?single",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 13",
            file: "https://t.me/c/2299629125/4/28108?single",
          },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 14", file: "https://t.me/c/2299629125/4/28328" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 15", file: "https://t.me/c/2299629125/4/28876" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 16", file: "https://t.me/c/2299629125/4/30152" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 17", file: "https://t.me/c/2299629125/4/30620" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 18", file: "https://t.me/c/2299629125/4/31220" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 19", file: "https://t.me/c/2299629125/4/31502" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 20", file: "https://t.me/c/2299629125/4/31574" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 21", file: "https://t.me/c/2299629125/4/31678" },
          { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 22", file: "https://t.me/c/2299629125/4/33727" },
        ],
        " Ø¹Ø±Ø¨ÙŠ": [
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 1",
            file: "https://t.me/c/2299629125/6/31685?single",
            video: "https://youtu.be/wlBIvz_dTXE?si=DiRX6LvEI_udXyLB",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 2",
            file: "https://t.me/c/2299629125/5/27302",
            video: "https://youtu.be/q1-auicu-bE?si=hpPgLbheY7432t_w",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 3",
            file: "https://t.me/c/2299629125/5/27324",
            video: "https://youtu.be/AhYq6ZZiKVQ?si=W-L2CB4o1ZrKzVVa",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 4",
            file: "https://t.me/c/2299629125/5/27353",
            video: "https://youtu.be/EnRTnXnSEYk?si=066sWTmFgJ9sCVyo",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 5",
            file: "https://t.me/c/2299629125/5/27377",
            video: "https://youtu.be/PGZ0TV8jTCs?si=Z7mfqHU3yEtn9UNg",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 6",
            file: "https://t.me/c/2299629125/5/27399",
            video: "https://youtu.be/kYQr7_15wQE?si=S6FhBZbAhA7doVHi",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 7",
            file: "https://t.me/c/2299629125/5/27421",
            video: "https://youtu.be/YQDznKlEkrI?si=5Ydv3nEPMfhYLPm7",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 8",
            file: "https://t.me/c/2299629125/5/27442",
            video: "https://youtu.be/5mSEfprkYUc?si=WdkxXlHDE8sM8o_A",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 9",
            file: "https://t.me/c/2299629125/5/27464",
            video: "https://youtu.be/D36OQYWPAs0?si=qmYQtxEZEAUOzSFj",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 10",
            file: "https://t.me/c/2299629125/5/32883",
            video: "https://youtu.be/TLlsGuLN2HI?si=fl4oHKgpqbme8ZR_",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 11",
            file: "https://t.me/c/2299629125/5/32907",
            video: "https://youtu.be/Jp-Wdxm8lx8?si=xFbwbSoDNahg8gVU",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 12",
            file: "https://t.me/c/2299629125/5/32954",
            video: "https://youtu.be/Fu7WGlj6Qb0?si=XtxZx6ITA-dbBjus",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 13",
            file: "https://t.me/c/2299629125/5/32977",
            video: "https://youtu.be/wgNUImdSLr8?si=anukyXsgn3lm7Afp",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 14",
            file: "https://t.me/c/2299629125/5/32998",
            video: "https://youtu.be/bIMfCEPEDhI?si=3-rXSaQswJyTFl9t",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 15",
            file: "https://t.me/c/2299629125/5/33020",
            video: "https://youtu.be/Cpv1SpgNJzY?si=GKa7jcCP-HSJ_GpU",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 16",
            file: "https://t.me/c/2299629125/5/32429",
            video: "https://youtu.be/ZDSbRvYQhXM?si=RLwhm_Zpx0F0JETh",
          },
          {
            title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 17",
            file: "https://t.me/c/2299629125/5/33187",
            video: "https://youtu.be/bNJ08KVhME8?si=oEYnWMRor3Nm2BlH",
          },
        ],
        " Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ": [
          { title: "Ù†Ù…ÙˆØ°Ø¬ 1", file: "https://t.me/c/2299629125/31685" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 2", file: "https://t.me/c/2299629125/31686" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 3", file: "https://t.me/c/2299629125/31687" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 4", file: "https://t.me/c/2299629125/27885" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 5", file: "https://t.me/c/2299629125/27935" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 6", file: "https://t.me/c/2299629125/28069" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 7", file: "https://t.me/c/2299629125/28113" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 8", file: "https://t.me/c/2299629125/28287" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 9", file: "https://t.me/c/2299629125/28325" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 10", file: "https://t.me/c/2299629125/28430" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 11", file: "https://t.me/c/2299629125/28534" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 12", file: "https://t.me/c/2299629125/28762" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 13", file: "https://t.me/c/2299629125/29676" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 14", file: "https://t.me/c/2299629125/29875" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 15", file: "https://t.me/c/2299629125/30292" },
          { title: "Ù†Ù…ÙˆØ°Ø¬ 16", file: "https://t.me/c/2299629125/31034" },
        ],
      };

      // Ø­ÙØ¸ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ÙÙŠ Firestore
      async function saveLinksDataToFirestore() {
        try {
          const linksDataRef = doc(db, "appData", "linksData");
          await setDoc(linksDataRef, { sections: linksData });
          return true;
        } catch (error) {
          console.error("Error saving links data:", error);
          return false;
        }
      }

      // Ø¬Ù„Ø¨ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ù…Ù† Firestore
      async function loadLinksDataFromFirestore() {
        try {
          const linksDataRef = doc(db, "appData", "linksData");
          const snap = await getDoc(linksDataRef);

          if (snap.exists()) {
            const data = snap.data();
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firestore Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
            if (data.sections) {
              Object.assign(linksData, data.sections);
            }
          } else {
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Ø§Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            await saveLinksDataToFirestore();
          }
        } catch (error) {
          console.error("Error loading links data:", error);
        }
      }

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
      loadLinksDataFromFirestore();

      // ======================= Generate Modules for all Sections =======================
      async function generateModules(section) {
        const container = document.getElementById("content");
        container.innerHTML = "";
        const userData = await getUserData();

        // âœ¨ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙˆØ± ÙÙˆÙ‚
        const heading = document.createElement("h2");
        heading.innerText = section; // Ø§Ø³Ù… Ø§Ù„Ù…Ø­ÙˆØ± Ù†ÙØ³Ù‡
        heading.classList.add("section-heading"); // Ù„Ùˆ Ø¹Ø§ÙŠØ²Ø© ØªØªØ­ÙƒÙ…ÙŠ Ø¨Ø§Ù„Ù€CSS
        container.appendChild(heading);

        for (let i = 0; i < linksData[section].length; i++) {
          const item = linksData[section][i];

          const block = document.createElement("div");
          block.className = "module";

          const header = document.createElement("div");
          header.className = "module-header";

          const title = document.createElement("h2");
          title.innerText = item.title || `${section} - Ø¹Ù†ØµØ± ${i + 1}`;
          header.appendChild(title);

          if (item.video) {
            const videoBtn = document.createElement("button");
            videoBtn.textContent = "ÙØªØ­ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ";
            videoBtn.classList.add("module-btn");
            videoBtn.onclick = () => window.open(item.video, "_blank");
            header.appendChild(videoBtn);
          }

          if (item.file) {
            const fileBtn = document.createElement("button");
            fileBtn.textContent = "ÙØªØ­ Ø§Ù„Ù…Ù„Ù";
            fileBtn.classList.add("module-btn");
            fileBtn.onclick = () => window.open(item.file, "_blank");
            header.appendChild(fileBtn);
          }

          block.appendChild(header);
          tasks.forEach((task, idx) => {
            const taskDiv = document.createElement("div");
            taskDiv.className = "task";

            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            const taskKey = `${section}_item_${i}_${idx}`;
            checkbox.checked = userData.completedTasks?.[taskKey] || false;

            // âœ¨ Ù†Ø­Ø¯Ø¯ Ø¥Ø°Ø§ Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ø§Ù„Ù€ checkbox Ù…ÙØ¹Ù„ Ø£Ùˆ Ù…Ù‚ÙÙˆÙ„
            if (
              (task === "Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ" && !item.video) ||
              (task === "Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬" && !item.file)
            ) {
              checkbox.disabled = true;
              checkbox.title = "ØºÙŠØ± Ù…ØªØ§Ø­ Ù„Ø£Ù†Ù‡ Ù„Ø§ ÙŠÙˆØ¬Ø¯ " + task; // Tooltip ØµØºÙŠØ±
              taskDiv.classList.add("disabled-task"); // Ù„Ø¥Ø¶Ø§ÙØ© Ø³ØªØ§ÙŠÙ„ Ø¨Ø§Ù‡Øª
            }

            if (checkbox.checked) taskDiv.classList.add("completed");
            checkbox.setAttribute("data-task", taskKey);

            checkbox.addEventListener("change", async () => {
              await updateTask(section, `item_${i}_${idx}`, checkbox.checked);
              taskDiv.classList.toggle("completed", checkbox.checked);
              updateProgressBar();

              const itemCompleted = tasks.every((_, tIdx) => {
                const cb = document.querySelector(
                  `input[data-task="${section}_item_${i}_${tIdx}"]`
                );
                return cb?.disabled || cb?.checked;
              });

              if (itemCompleted) {
                showBanner(
                  `Ø¬Ø±ÙˆØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ¨ Ù…Ø¨Ø³ÙˆØ· Ø¨ÙŠÙƒ ğŸ¥³ Ø®Ù„ØµØª ${item.title} ÙŠØ§ ${username}!`
                );
                launchConfetti(60, 3000);
              }

              await checkSectionCompletion(section);
            });

            const label = document.createElement("label");
            label.textContent = task;
            taskDiv.appendChild(label);
            taskDiv.appendChild(checkbox);
            block.appendChild(taskDiv);
          });

          container.appendChild(block);
        }
      }

      // ======================= User Data =======================
      async function getUserData(name) {
        const userRef = doc(db, "users", name);
        const docSnap = await getDoc(userRef);
        return docSnap.exists() ? docSnap.data() : null;
      }

      async function updateTask(
        user,
        section,
        moduleIndex,
        taskIndex,
        isChecked
      ) {
        const userRef = doc(db, "users", user);
        const userData = (await getDoc(userRef)).data() || { progress: {} };

        if (!userData.progress[section]) userData.progress[section] = [];
        if (!userData.progress[section][moduleIndex])
          userData.progress[section][moduleIndex] = [];

        userData.progress[section][moduleIndex][taskIndex] = isChecked;

        await setDoc(userRef, userData);
        updateProgressBar(userData, section);
        checkSectionCompletion(userData, section);
      }

      // ======================= Progress Bar =======================
      function updateProgressBar(userData, section) {
        const modules = (userData.progress[section] || []).flat();
        const completed = modules.filter(Boolean).length;
        const total = modules.length || 1;
        const percentage = Math.round((completed / total) * 100);
        const bar = document.getElementById("progress-bar");

        bar.style.width = percentage + "%";
        bar.textContent = percentage + "%";
      }

      function checkSectionCompletion(userData, section) {
        const modules = (userData.progress[section] || []).flat();
        if (modules.length > 0 && modules.every(Boolean)) {
          triggerCelebration();
        }
      }

      // ======================= Navigation =======================
      function backToModules() {
        document.getElementById("main").style.display = "none";
        document.getElementById("module-grid").style.display = "block";
      }

      function backToStart() {
        document.getElementById("module-grid").style.display = "none";
        document.getElementById("start-screen").style.display = "block";
      }

      // ======================= Banner & Confetti =======================
      function triggerCelebration() {
        const banner = document.getElementById("celebrateBanner");
        banner.style.display = "block";
        setTimeout(() => (banner.style.display = "none"), 3000);
        confetti();
      }

      // ======================= Leaderboard =======================
      async function loadLeaderboard() {
        const lbBody = document.getElementById("lbBody");
        lbBody.innerHTML = "";

        const querySnapshot = await getDocs(collection(db, "users"));
        let users = [];

        querySnapshot.forEach((doc) => {
          const data = doc.data();
          let completed = 0,
            total = 0;

          for (const section in data.progress) {
            data.progress[section].forEach((module) => {
              module.forEach((task) => {
                total++;
                if (task) completed++;
              });
            });
          }

          const percentage = total ? Math.round((completed / total) * 100) : 0;
          users.push({ name: doc.id, progress: percentage });
        });

        users.sort((a, b) => b.progress - a.progress);

        users.forEach((user, index) => {
          const row = `<tr>
      <td>${index + 1}</td>
      <td>${user.name}</td>
      <td>${user.progress}%</td>
      <td>${user.progress == 100 ? "ğŸ…" : ""}</td>
    </tr>`;
          lbBody.innerHTML += row;
        });
      }

      document
        .getElementById("btnLeaderboard")
        .addEventListener("click", () => {
          document.getElementById("start-screen").style.display = "none";
          document.getElementById("module-grid").style.display = "none";
          document.getElementById("main").style.display = "none";
          document.getElementById("screen-lb").style.display = "block";
          loadLeaderboard();
        });

      function closeLeaderboard() {
        document.getElementById("screen-lb").style.display = "none";
        document.getElementById("start-screen").style.display = "block";
      }
    </script>
  </body>
</html>
