<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¹Ø¶Ø§Ø¡ Ø¬Ø±ÙˆØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ¨</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Cairo", sans-serif;
      }
      body {
        background: #f5f5f5;
        color: #333;
      }
      .hidden {
        display: none;
      }
      .page {
        padding: 20px;
        text-align: center;
      }
      .row-gap {
        display: flex;
        gap: 12px;
        justify-content: center;
        margin-top: 12px;
        flex-wrap: wrap;
      }
      .btn {
        cursor: pointer;
        padding: 10px 18px;
        border-radius: 8px;
        border: none;
        font-weight: bold;
        transition: 0.3s;
      }
      .btn-primary {
        background: #0096c7;
        color: #fff;
      }
      .btn-ghost {
        background: transparent;
        color: #0096c7;
        border: 2px solid #0096c7;
      }
      .link-btn {
        background: #e6f7fb;
        color: #0096c7;
      }
      .start-input {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        width: 220px;
        text-align: center;
      }
      .modules-wrap {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        justify-content: center;
        margin-top: 20px;
      }
      .module-button {
        background: #fff;
        border: 2px solid #ccc;
        border-radius: 15px;
        padding: 18px 20px;
        font-size: 18px;
        min-width: 200px;
        cursor: pointer;
        position: relative;
        transition: 0.3s;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }
      .module-button:hover {
        transform: translateY(-5px);
        background: #d9fdd3;
      }
      .module-button.done {
        border-color: #22c55e;
      }
      .module-check {
        position: absolute;
        top: 10px;
        left: 12px;
        font-size: 18px;
        color: #22c55e;
        display: none;
      }
      .module-button.done .module-check {
        display: block;
      }
      main {
        padding: 20px;
      }
      .module {
        background: #fff;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        border: 1px solid #ccc;
      }
      .module h2 {
        margin-top: 0;
        color: #023e8a;
        border-bottom: 2px solid #ccc;
        padding-bottom: 10px;
        margin-bottom: 12px;
      }
      .model-title {
        background: #dbeafe;
        color: #1e3a8a;
        padding: 8px 12px;
        border-radius: 8px;
        margin: 14px 0 8px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 8px;
        justify-content: space-between;
        flex-wrap: wrap;
      }
      .open-btn {
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid #0096c7;
        background: #e6f7fb;
        cursor: pointer;
        font-size: 14px;
      }
      .task {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px dashed #ccc;
      }
      .task input[type="checkbox"] {
        transform: scale(1.2);
        accent-color: #00b4d8;
      }
      .task.completed {
        background: #d9fdd3;
        border-radius: 5px;
      }
      .motivator {
        margin-top: 18px;
        font-size: 18px;
        text-align: center;
        font-weight: bold;
        color: #2e7d32;
      }
      .back-btn {
        background: #aaa;
        color: #fff;
        padding: 8px 15px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        margin-bottom: 12px;
      }
      .progress-container {
        width: 100%;
        background: #ddd;
        border-radius: 20px;
        height: 24px;
        margin: 10px 0 16px;
        overflow: hidden;
      }
      .progress-bar {
        height: 100%;
        width: 0%;
        background: #00b4d8;
        text-align: center;
        color: #fff;
        font-weight: bold;
        transition: width 0.4s ease;
      }
      .leaderboard table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 12px;
      }
      .leaderboard th,
      .leaderboard td {
        padding: 8px;
        border-bottom: 1px solid #ccc;
        text-align: center;
        font-size: 14px;
      }
      @media (max-width: 600px) {
        .leaderboard table,
        .leaderboard thead,
        .leaderboard tbody,
        .leaderboard th,
        .leaderboard td,
        .leaderboard tr {
          display: block;
        }
        .leaderboard tr {
          margin-bottom: 12px;
        }
        .leaderboard td {
          text-align: right;
          padding-left: 50%;
          position: relative;
        }
        .leaderboard td::before {
          position: absolute;
          left: 10px;
          width: 45%;
          white-space: nowrap;
          font-weight: bold;
        }
      }
    </style>
  </head>
  <body>
    <section id="screen-start" class="page">
      <img src="5776125144014639249.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ø±ÙˆØ¨" width="100" />
      <h1>Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¹Ø¶Ø§Ø¡ Ø¬Ø±ÙˆØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ¨</h1>
      <input id="nameInput" class="start-input" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ" />
      <div class="row-gap">
        <button class="btn btn-primary" id="btnStart">
          Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¢Ù†
        </button>
        <button class="btn btn-ghost" id="btnGoLB">Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ğŸ†</button>
      </div>
    </section>
    <section id="screen-modules" class="page hidden">
      <h2>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙˆØ± Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</h2>
      <div class="row-gap">
        <button class="btn link-btn" id="btnBackToStart">Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
        <button class="btn link-btn" id="btnLeaderboard1">
          Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ğŸ†
        </button>
      </div>
      <div class="modules-wrap" id="modules-container"></div>
    </section>
    <main id="screen-main" class="page hidden">
      <div class="bar-top">
        <button class="back-btn" id="btnBackToModules">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
        <button class="link-btn" id="btnLeaderboard2">Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ğŸ†</button>
      </div>
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar">0%</div>
      </div>
      <div id="content"></div>
      <div class="motivator" id="motivator"></div>
    </main>
    <section id="screen-lb" class="page leaderboard hidden">
      <div class="lb-card">
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ğŸ†</h2>
        <table class="lb-list" id="lbTable">
          <thead>
            <tr>
              <th>Ø§Ù„Ø§Ø³Ù…</th>
              <th>Ø§Ù„Ù†Ø³Ø¨Ø© %</th>
              <th>Ø§Ù„ÙˆØ³Ø§Ù…</th>
              <th>ØªØ´Ø¬ÙŠØ¹</th>
            </tr>
          </thead>
          <tbody id="lbBody"></tbody>
        </table>
      </div>
    </section>
    <script>
      const tasks = ["Ù…Ø°Ø§ÙƒØ±Ø©/Ù…Ø´Ø§Ù‡Ø¯Ø©", "Ø­Ù„ Ø§Ù„Ø§Ø³ØªÙØªØ§Ø¡Ø§Øª", "Ø­Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨ÙˆÙ‚Øª"];
      const prayers = [
        "Ø§Ù„Ù„Ù‡Ù… ÙˆÙÙ‚Ù†ÙŠ ÙˆØ«Ø¨ØªÙ†ÙŠ ÙˆØ¨Ø§Ø±Ùƒ Ù„ÙŠ ÙÙŠ ÙˆÙ‚ØªÙŠ ÙˆØ¬Ù‡Ø¯ÙŠ ğŸ¤²",
        "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù„Ù… Ø­Ø¬Ø© Ù„ÙŠ Ù„Ø§ Ø¹Ù„ÙŠ ğŸ’¡",
      ];
      const moduleData = {
        "ğŸ“˜ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©": { type: "models", count: 5 },
        "ğŸ’» Ø­Ø§Ø³Ø¨": {
          type: "list",
          items: [
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 1", url: "https://youtu.be/aTGmvmeDJf8" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 2", url: "https://youtu.be/9tye0LUQfYI" },
          ],
        },
      };
      let username = "",
        selectedSection = "",
        userKey = "",
        userData = {},
        completedSections = {};
      document.getElementById("btnStart").onclick = () => {
        const name = document.getElementById("nameInput").value.trim();
        if (!name) return;
        username = name;
        userKey = `user_${username}`;
        userData = JSON.parse(localStorage.getItem(userKey) || "{}");
        completedSections = JSON.parse(
          localStorage.getItem(userKey + "_completedSections") || "{}"
        );
        document.getElementById("screen-start").classList.add("hidden");
        document.getElementById("screen-modules").classList.remove("hidden");
        renderModules();
      };
      function renderModules() {
        const wrap = document.getElementById("modules-container");
        wrap.innerHTML = "";
        for (const section in moduleData) {
          const btn = document.createElement("button");
          btn.className =
            "module-button" + (completedSections[section] ? " done" : "");
          btn.innerHTML = `${section}<span class='module-check'>âœ…</span>`;
          btn.onclick = () => openModule(section);
          wrap.appendChild(btn);
        }
      }
      function openModule(section) {
        selectedSection = section;
        document.getElementById("screen-modules").classList.add("hidden");
        document.getElementById("screen-main").classList.remove("hidden");
        generateModules(section);
        updateProgressBar();
      }
      function generateModules(section) {
        const container = document.getElementById("content");
        container.innerHTML = "";
        const data = moduleData[section];
        const moduleDiv = document.createElement("div");
        moduleDiv.className = "module";
        const title = document.createElement("h2");
        title.textContent = section;
        moduleDiv.appendChild(title);
        if (data.type === "models") {
          for (let i = 1; i <= data.count; i++)
            addBlock(moduleDiv, section, `model_${i}`, `ğŸ“„ Ù†Ù…ÙˆØ°Ø¬ ${i}`);
        } else if (data.type === "list") {
          data.items.forEach((item, idx) =>
            addBlock(
              moduleDiv,
              section,
              `item_${idx + 1}`,
              item.title,
              item.url
            )
          );
        }
        container.appendChild(moduleDiv);
      }
      function addBlock(parent, section, id, titleText, url = "") {
        const header = document.createElement("div");
        header.className = "model-title";
        const left = document.createElement("span");
        left.textContent = titleText;
        header.appendChild(left);
        if (url) {
          const btn = document.createElement("button");
          btn.className = "open-btn";
          btn.textContent = "ÙØªØ­ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ";
          btn.onclick = () => window.open(url, "_blank");
          header.appendChild(btn);
        }
        parent.appendChild(header);
        tasks.forEach((task, idx) => {
          const div = document.createElement("div");
          div.className = "task";
          const chk = document.createElement("input");
          chk.type = "checkbox";
          const key = `${section}_${id}_${idx}`;
          if (userData[key]) {
            chk.checked = true;
            div.classList.add("completed");
          }
          chk.onchange = () => {
            userData[key] = chk.checked;
            localStorage.setItem(userKey, JSON.stringify(userData));
            div.classList.toggle("completed", chk.checked);
            updateProgressBar();
            checkSectionCompletion(section);
          };
          const lbl = document.createElement("label");
          lbl.textContent = task;
          div.appendChild(lbl);
          div.appendChild(chk);
          parent.appendChild(div);
        });
      }
      function getSectionProgress(section) {
        let total = 0,
          completed = 0;
        const data = moduleData[section];
        let ids = [];
        if (data.type === "models")
          ids = Array.from({ length: data.count }, (_, i) => `model_${i + 1}`);
        else if (data.type === "list")
          ids = data.items.map((_, i) => `item_${i + 1}`);
        ids.forEach((id) =>
          tasks.forEach((_, i) => {
            total++;
            if (userData[`${section}_${id}_${i}`]) completed++;
          })
        );
        return { completed, total };
      }
      function updateProgressBar() {
        const { completed, total } = getSectionProgress(selectedSection);
        const pct = total ? Math.round((completed / total) * 100) : 0;
        const bar = document.getElementById("progress-bar");
        bar.style.width = pct + "%";
        bar.textContent = pct + "%";
        showMotivation(pct);
      }
      function showMotivation(pct) {
        const motivator = document.getElementById("motivator");
        if (pct === 100) {
          const msg = prayers[Math.floor(Math.random() * prayers.length)];
          motivator.textContent = `Ø¬Ø±ÙˆØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù„Ù„ØªØ¯Ø±ÙŠØ¨ Ù…Ø¨Ø³ÙˆØ· Ø¨Ø¥Ù†Ø¬Ø§Ø²Ùƒ! ğŸ‰\n${msg}`;
          completedSections[selectedSection] = true;
          localStorage.setItem(
            userKey + "_completedSections",
            JSON.stringify(completedSections)
          );
          renderModules();
        } else motivator.textContent = "";
      }
      function checkSectionCompletion(section) {
        const { completed, total } = getSectionProgress(section);
        if (completed === total) completedSections[section] = true;
        else delete completedSections[section];
        localStorage.setItem(
          userKey + "_completedSections",
          JSON.stringify(completedSections)
        );
        renderModules();
      }
      // ===== Leaderboard =====
      function renderLeaderboard() {
        const lbBody = document.getElementById("lbBody");
        lbBody.innerHTML = "";
        const users = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (!key.startsWith("user_") || key.endsWith("_completedSections"))
            continue;
          const name = key.replace("user_", "");
          const data = JSON.parse(localStorage.getItem(key));
          let completed = 0,
            total = 0;
          for (const k in data) {
            total++;
            if (data[k]) completed++;
          }
          const pct = total ? Math.round((completed / total) * 100) : 0;
          let medal = "";
          if (pct >= 90) medal = "ğŸ¥‡";
          else if (pct >= 70) medal = "ğŸ¥ˆ";
          else if (pct >= 50) medal = "ğŸ¥‰";
          let msg = "ÙˆØ§ØµÙ„ Ù‡ÙƒØ°Ø§!";
          if (pct >= 90) msg = "Ù…Ù…ØªØ§Ø²! Ø§Ø³ØªÙ…Ø±!";
          else if (pct >= 70) msg = "Ø­Ø³Ù†Ù‹Ø§! Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ù‚Ù…Ø©!";
          users.push({ name, pct, medal, msg });
        }
        users.sort((a, b) => b.pct - a.pct);
        users.forEach((u) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${u.name}</td><td>${u.pct}</td><td>${u.medal}</td><td>${u.msg}</td>`;
          lbBody.appendChild(tr);
        });
      }
      // ===== Buttons =====
      document.getElementById("btnGoLB").onclick = () => {
        document.getElementById("screen-start").classList.add("hidden");
        document.getElementById("screen-lb").classList.remove("hidden");
        renderLeaderboard();
      };
      document.getElementById("btnLeaderboard1").onclick = () => {
        document.getElementById("screen-modules").classList.add("hidden");
        document.getElementById("screen-lb").classList.remove("hidden");
        renderLeaderboard();
      };
      document.getElementById("btnLeaderboard2").onclick = () => {
        document.getElementById("screen-main").classList.add("hidden");
        document.getElementById("screen-lb").classList.remove("hidden");
        renderLeaderboard();
      };
      document.getElementById("btnBackToStart").onclick = () => {
        document.getElementById("screen-modules").classList.add("hidden");
        document.getElementById("screen-start").classList.remove("hidden");
      };
      document.getElementById("btnBackToModules").onclick = () => {
        document.getElementById("screen-main").classList.add("hidden");
        document.getElementById("screen-modules").classList.remove("hidden");
      };
    </script>
  </body>
</html>
