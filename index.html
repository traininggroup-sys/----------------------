<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¬Ø±ÙˆØ¨ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      body {
        margin: 0;
        font-family: "Cairo", sans-serif;
        background: linear-gradient(to right, #f5f5f5, #eaeaea);
        color: #333;
      }
      .start-screen,
      .module-select-screen {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #004e64;
        text-align: center;
        padding: 20px;
      }
      .start-screen h1 {
        font-size: 32px;
        color: #fff;
        margin-bottom: 10px;
      }
      .start-screen img {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 50%;
        border: 3px solid #fff;
        margin-bottom: 15px;
      }
      .start-btn {
        padding: 12px 30px;
        font-size: 18px;
        background: #0096c7;
        border: none;
        border-radius: 30px;
        color: #fff;
        cursor: pointer;
      }
      .module-grid {
        display: none;
        padding: 40px 20px;
        background: #f0f8ff;
        text-align: center;
      }
      .module-grid h2 {
        margin-bottom: 20px;
      }
      .modules-wrap {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        justify-content: center;
      }
      .module-button {
        position: relative;
        background: #fff;
        border: 2px solid #ccc;
        border-radius: 15px;
        padding: 20px 18px;
        font-size: 18px;
        min-width: 220px;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .module-button:hover {
        transform: translateY(-5px);
        background: #d9fdd3;
      }
      .module-button i {
        display: block;
        font-size: 28px;
        margin-bottom: 8px;
      }
      .module-check {
        position: absolute;
        top: 10px;
        left: 12px;
        font-size: 18px;
        color: #22c55e;
        display: none;
      }
      .module-button.done .module-check {
        display: block;
      }
      main {
        display: none;
        padding: 20px;
        background: #fafafa;
      }
      .module {
        background: #fff;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        border: 1px solid #ccc;
      }
      .module h2 {
        margin-top: 0;
        color: #023e8a;
        border-bottom: 2px solid #ccc;
        padding-bottom: 10px;
        margin-bottom: 12px;
      }
      .model-title {
        background: #dbeafe;
        color: #1e3a8a;
        padding: 8px 12px;
        border-radius: 8px;
        margin: 14px 0 8px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 8px;
        justify-content: space-between;
        flex-wrap: wrap;
      }
      .open-btn {
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid #0096c7;
        background: #e6f7fb;
        cursor: pointer;
        font-size: 14px;
      }
      .task {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px dashed #ccc;
      }
      .task input[type="checkbox"] {
        transform: scale(1.2);
        accent-color: #00b4d8;
      }
      .task.completed {
        background: #d9fdd3;
        border-radius: 5px;
      }
      .motivator {
        margin-top: 18px;
        font-size: 18px;
        text-align: center;
        font-weight: bold;
        color: #2e7d32;
      }
      #admin-tools {
        display: none;
        margin: 16px 0;
        padding: 12px;
        border: 2px dashed #888;
        background: #eef;
        border-radius: 10px;
      }
      .admin-actions {
        margin-top: 10px;
      }
      .back-btn {
        background: #aaa;
        color: #fff;
        padding: 8px 15px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        margin-bottom: 12px;
      }
      /* Progress bar */
      .progress-container {
        width: 100%;
        background: #ddd;
        border-radius: 20px;
        height: 24px;
        margin: 10px 0 16px;
        overflow: hidden;
      }
      .progress-bar {
        height: 100%;
        width: 0%;
        background: #00b4d8;
        text-align: center;
        color: #fff;
        font-weight: bold;
        transition: width 0.4s ease;
      }
      /* Celebration banner */
      .celebrate-banner {
        position: fixed;
        top: -80px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(90deg, #22c55e, #06b6d4, #3b82f6);
        color: #fff;
        padding: 14px 20px;
        border-radius: 999px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        z-index: 9999;
        white-space: nowrap;
        font-weight: 700;
      }
      .celebrate-banner.show {
        top: 20px;
        transition: top 0.5s ease;
      }
      /* Confetti */
      .confetti {
        position: fixed;
        top: -10px;
        font-size: 22px;
        animation: fall linear forwards;
        z-index: 9998;
      }
      @keyframes fall {
        to {
          transform: translateY(110vh) rotate(720deg);
          opacity: 0.9;
        }
      }
    </style>
  </head>
  <body>
    <section class="start-screen" id="start-screen">
      <img src="5776125144014639249.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ø±ÙˆØ¨" />
      <h1>Ø¬Ø±ÙˆØ¨ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</h1>
      <input
        id="nameInput"
        placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ"
        style="padding: 10px; margin: 10px; border-radius: 10px; border: none"
      />
      <button class="start-btn" onclick="startApp()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¢Ù†</button>
    </section>

    <section class="module-grid" id="module-grid">
      <h2>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙˆØ± Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</h2>
      <div class="modules-wrap" id="modules-container"></div>
    </section>

    <main id="main">
      <button class="back-btn" onclick="goBack()">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>

      <div class="progress-container">
        <div class="progress-bar" id="progress-bar">0%</div>
      </div>

      <div id="admin-tools">
        <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù…Ø´Ø±ÙØ© (Ù†Ø¬Ù„Ø§)</h3>
        <select id="module-select"></select>
        <div class="admin-actions">
          <button onclick="addModel()">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ±</button>
          <button onclick="confirmRemoveModel()">ğŸ—‘ï¸ Ø­Ø°Ù Ø¢Ø®Ø± Ø¹Ù†ØµØ±</button>
        </div>
      </div>

      <div id="content"></div>
      <div class="motivator" id="motivator"></div>
    </main>

    <!-- Celebration banner -->
    <div id="celebrateBanner" class="celebrate-banner">
      ğŸ† Ø¨Ø±Ø§ÙÙˆÙˆ! Ø¥Ù†Ø¬Ø§Ø² Ø±Ù‡ÙŠØ¨!
    </div>

    <script>
      const adminName = "Ù†Ø¬Ù„Ø§";
      const tasks = ["Ù…Ø°Ø§ÙƒØ±Ø©/Ù…Ø´Ø§Ù‡Ø¯Ø©", "Ø­Ù„ Ø§Ù„Ø§Ø³ØªÙØªØ§Ø¡Ø§Øª", "Ø­Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨ÙˆÙ‚Øª"];
      const prayers = [
        "Ø§Ù„Ù„Ù‡Ù… ÙˆÙÙ‚Ù†ÙŠ ÙˆØ«Ø¨ØªÙ†ÙŠ ÙˆØ¨Ø§Ø±Ùƒ Ù„ÙŠ ÙÙŠ ÙˆÙ‚ØªÙŠ ÙˆØ¬Ù‡Ø¯ÙŠ ğŸ¤²",
        "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù„Ù… Ø­Ø¬Ø© Ù„ÙŠ Ù„Ø§ Ø¹Ù„ÙŠ ğŸ’¡",
        "ÙŠØ§ Ø±Ø¨ Ø³Ù‡Ù„ Ù„ÙŠ ÙˆÙ„Ø§ ØªØ¹Ø³Ø± Ø£Ù…Ø±ÙŠ âœ¨",
        "Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†ÙŠ Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ø³Ù„ÙŠÙ… ÙˆØ§Ù„Ø­ÙØ¸ Ø§Ù„Ù‚ÙˆÙŠ ğŸ“š",
        "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ù†Ù‡Ø§ÙŠØªÙ‡ ØªÙˆÙÙŠÙ‚ ÙˆØ³Ø¹Ø§Ø¯Ø© ğŸ•Šï¸",
      ];

      let username = "";
      let selectedSection = "";
      let userKey = "";
      let userData = {};
      let completedSections = {}; // { section: true }

      const moduleData = {
        "ğŸ“˜ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©": { type: "models", count: 22, icon: "fa-lightbulb" },
        "ğŸ’» Ø­Ø§Ø³Ø¨": {
          type: "list",
          icon: "fa-computer",
          // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø­Ø§Ø³Ø¨ Ø¨Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø±Ø§Ø¨Ø· (ÙƒÙ…Ø§ Ø£Ø±Ø³Ù„ØªÙŠ)
          items: [
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 1", url: "https://youtu.be/aTGmvmeDJf8" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 2", url: "https://youtu.be/9tye0LUQfYI" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 3", url: "https://youtu.be/N3Z5p65om0o" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 4", url: "https://youtu.be/_HwWcpqTdHI" },
            // Ù¥ Ù…Ø­Ø°ÙˆÙ
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 6", url: "https://youtu.be/1DbFtQZpsW0" },
            { title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ Excel", url: "https://youtu.be/JzsTom7tTx8" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 7", url: "https://youtu.be/jUBGca5qRnM" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 8", url: "https://youtu.be/q3Zz99bThyQ" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 9", url: "https://youtu.be/_Ea_z_Ft4bs" },
            {
              title: "Ø´Ø±Ø­ Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù„ÙŠ Excel",
              url: "https://youtu.be/qn5rs-4mFJo",
            },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 10", url: "https://youtu.be/hRAdE691Mg4" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 11", url: "https://youtu.be/LNlw1VhnDWM" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 12", url: "https://youtu.be/mdgj-gbvOIg" },
            { title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ Excel", url: "https://youtu.be/GI8RU0FXXO4" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 13", url: "https://youtu.be/sTGkL7xYwCE" },
            { title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ Access", url: "https://youtu.be/SOFszLmW_X8" },
            {
              title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ PowerPoint Ø¬Ø²Ø¡ Ù¡",
              url: "https://youtu.be/53ydwEIFrog",
            },
            {
              title: "Ø¨Ø±Ù†Ø§Ù…Ø¬ PowerPoint Ø¬Ø²Ø¡ Ù¢",
              url: "https://youtu.be/yCvhQdWY0ac",
            },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 14", url: "https://youtu.be/8ypgm2RJ804" },
            { title: "Ø£Ù‡Ù… Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª", url: "https://youtu.be/lhjovAocMMw" },
            { title: "Ø§Ø³Ø¦Ù„Ø© Ù…Ø¬Ù…Ø¹Ø©", url: "https://youtu.be/BgYzh47Icm0" },
            { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 1", url: "https://youtu.be/evZEGltYYXs" },
            { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 2", url: "https://youtu.be/U_jAqbzbjRA" },
            { title: "Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 3", url: "https://youtu.be/IkT_6INmCyY" },
            { title: "ÙÙŠØ¯ÙŠÙˆ Ø±Ù‚Ù… 15", url: "https://youtu.be/9AY9POUJYLc" },
            {
              title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„Ù„Ø­Ø§Ø³Ø¨ Ø¬Ø²Ø¡ Ù¡",
              url: "https://youtu.be/2V0fQEpAeiM",
            },
            {
              title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„Ù„Ø­Ø§Ø³Ø¨ Ø¬Ø²Ø¡ Ù¢",
              url: "https://youtu.be/W1Qcsu6hy4U",
            },
            { title: "Ù†Ù…ÙˆØ°Ø¬ Ø±Ù‚Ù… 9", url: "https://youtu.be/VtOe_dx5qn8" },
            {
              title: "Ø´Ø±Ø­ Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ ÙÙŠ Excel",
              url: "https://youtu.be/-uIb6ZpFEi4",
            },
            {
              title: "Ø´Ø±Ø­ Ø³Ø¤Ø§Ù„ Ù„Ø¹Ù…Ù„ ØªØ®Ø·ÙŠØ· Ù‡ÙŠÙƒÙ„ÙŠ Ù†Ø®ØªØ§Ø± Ø¥ÙŠÙ‡",
              url: "https://youtu.be/Odgj-G4pHUQ",
            },
            // Ø¨Ø¹Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª: Ù†Ø¶ÙŠÙ Ù†Ù…Ø§Ø°Ø¬ Ø¥Ø¶Ø§ÙÙŠØ© Ø¨Ù„Ø§ Ø±ÙˆØ§Ø¨Ø· Ù„ØªÙƒÙ…Ù„Ø© 22 Ù†Ù…ÙˆØ°Ø¬
            // Ù„Ùˆ Ø­Ø¨ÙŠØªÙŠ ØªØ´ÙŠÙ„ÙŠÙ‡Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø³Ù‡Ù„ Ø¬Ø¯Ø§Ù‹
            ...Array.from({ length: 22 - 4 }, (_, i) => ({
              // Ø¹Ù†Ø¯Ù†Ø§ Ø¨Ø§Ù„ÙØ¹Ù„ 4 Ù†Ù…Ø§Ø°Ø¬ Ù…Ø°ÙƒÙˆØ±Ø© (1,2,3,9)
              title: `Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙÙŠ ${i + 1}`,
              url: "",
            })),
          ],
        },
        "ğŸ—£ï¸ Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ": { type: "models", count: 16, icon: "fa-language" },
        "ğŸ“™ Ø¹Ø±Ø¨ÙŠ": { type: "models", count: 17, icon: "fa-book" },
      };

      // ====== APP CORE ======
      const startApp = () => {
        const nameInput = document.getElementById("nameInput");
        const name =
          nameInput.value.trim() || localStorage.getItem("savedName");
        if (!name) return;
        username = name;
        nameInput.value = name;
        localStorage.setItem("savedName", name);

        userKey = `centralUser_${username}`;
        userData = JSON.parse(localStorage.getItem(userKey)) || {};
        completedSections = JSON.parse(
          localStorage.getItem(`${userKey}_completedSections`) || "{}"
        );

        document.getElementById("start-screen").style.display = "none";
        document.getElementById("module-grid").style.display = "block";

        renderModuleButtons();
      };

      function renderModuleButtons() {
        const wrap = document.getElementById("modules-container");
        wrap.innerHTML = "";
        for (const section in moduleData) {
          const btn = document.createElement("button");
          btn.className =
            "module-button" + (completedSections[section] ? " done" : "");
          btn.innerHTML = `<i class='fas fa-book-open'></i>${section}<span class="module-check">âœ…</span>`;
          btn.onclick = () => openModule(section);
          wrap.appendChild(btn);
        }
      }

      const openModule = (section) => {
        selectedSection = section;
        document.getElementById("module-grid").style.display = "none";
        document.getElementById("main").style.display = "block";

        if (username === adminName) {
          document.getElementById("admin-tools").style.display = "block";
          const moduleSelect = document.getElementById("module-select");
          moduleSelect.innerHTML = "";
          for (const sec in moduleData) {
            const opt = document.createElement("option");
            opt.value = sec;
            opt.textContent = sec;
            if (sec === section) opt.selected = true;
            moduleSelect.appendChild(opt);
          }
        }

        generateModules(section);
        updateProgressBar(); // Ù…Ø¨Ø¯Ø¦ÙŠ
      };

      const goBack = () => {
        document.getElementById("main").style.display = "none";
        document.getElementById("module-grid").style.display = "block";
        renderModuleButtons();
      };

      // ====== RENDER SECTION ======
      const generateModules = (section) => {
        const container = document.getElementById("content");
        container.innerHTML = "";

        const data = moduleData[section];
        const moduleDiv = document.createElement("div");
        moduleDiv.className = "module";

        const title = document.createElement("h2");
        title.textContent = section;
        moduleDiv.appendChild(title);

        if (data.type === "models") {
          for (let i = 1; i <= data.count; i++) {
            addBlock(moduleDiv, section, `model_${i}`, `ğŸ“„ Ù†Ù…ÙˆØ°Ø¬ ${i}`);
          }
        } else if (data.type === "list") {
          data.items.forEach((item, idx) => {
            addBlock(
              moduleDiv,
              section,
              `item_${idx + 1}`,
              (item.url ? "ğŸ¬ " : "ğŸ“„ ") + item.title,
              item.url
            );
          });
        }

        container.appendChild(moduleDiv);
        showMotivation();
      };

      // block with tasks + optional open button
      function addBlock(parent, section, id, titleText, url = "") {
        const header = document.createElement("div");
        header.className = "model-title";
        const left = document.createElement("span");
        left.textContent = titleText;
        header.appendChild(left);

        if (url) {
          const openBtn = document.createElement("button");
          openBtn.className = "open-btn";
          openBtn.textContent = "ÙØªØ­ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ";
          openBtn.onclick = () => window.open(url, "_blank");
          header.appendChild(openBtn);
        }
        parent.appendChild(header);

        tasks.forEach((task, idx) => {
          const taskDiv = document.createElement("div");
          taskDiv.className = "task";

          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          const taskKey = `${section}_${id}_${idx}`;
          if (userData[taskKey]) {
            checkbox.checked = true;
            taskDiv.classList.add("completed");
          }

          checkbox.addEventListener("change", () => {
            userData[taskKey] = checkbox.checked;
            localStorage.setItem(userKey, JSON.stringify(userData));
            taskDiv.classList.toggle("completed", checkbox.checked);

            if (checkbox.checked) {
              // ØªØ³Ø¬ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
              fetch(
                "https://script.google.com/macros/s/AKfycbzjK9rFHOGNb0gq0d7uhlZMbgJTvsxbq4XIBU160u22cZusp_XI1M0ufsL82NUPOZjW/exec",
                {
                  method: "POST",
                  body: JSON.stringify({
                    name: username,
                    section,
                    model: id,
                    task,
                    completed: true,
                  }),
                  headers: { "Content-Type": "application/json" },
                }
              ).catch(() => {});
            }

            showMotivation();
            updateProgressBar();
            checkSectionCompletion(section);
          });

          const label = document.createElement("label");
          label.textContent = task;

          taskDiv.appendChild(label);
          taskDiv.appendChild(checkbox);
          parent.appendChild(taskDiv);
        });
      }

      // ====== PROGRESS + MOTIVATION ======
      function updateProgressBar() {
        const bar = document.getElementById("progress-bar");
        const { completed, total } = getSectionProgress(selectedSection);
        const pct = total ? Math.round((completed / total) * 100) : 0;
        bar.style.width = pct + "%";
        bar.textContent = pct + "%";
      }

      function getSectionProgress(section) {
        const data = moduleData[section];
        let itemsCount = 0;
        if (data.type === "models") itemsCount = data.count;
        else if (data.type === "list") itemsCount = data.items.length;

        const totalTasks = itemsCount * tasks.length;

        // count completed keys for this section
        let completed = 0;
        for (const [k, v] of Object.entries(userData)) {
          if (v && k.startsWith(section + "_")) completed++;
        }
        return { completed, total: totalTasks };
      }

      const showMotivation = () => {
        const done = Object.values(userData).filter(Boolean).length;
        const motivator = document.getElementById("motivator");
        if (done === 0)
          motivator.textContent = "Ø§Ø¨Ø¯Ø£ Ø£ÙˆÙ„ Ø®Ø·ÙˆØ© ÙˆÙ‡ØªÙ„Ø§Ù‚ÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø³Ù‡Ù„! ğŸ’ª";
        else if (done % 10 === 0)
          motivator.textContent = `ğŸ‘ Ù…Ù…ØªØ§Ø² ÙŠØ§ ${username}! Ø®Ù„ØµØª ${done} Ø®Ø·ÙˆØ©! Ø§Ø³ØªÙ…Ø±!`;
        else if (done > 50)
          motivator.textContent = `ğŸ”¥ Ø§Ù†Øª Ø¨Ø·Ù„ Ø¨Ø¬Ø¯ ÙŠØ§ ${username}ØŒ Ù‚Ø±Ø¨Øª ØªØ®Ù„Øµ ÙƒÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰!`;
        else motivator.textContent = "";
      };

      // ====== COMPLETION CHECK + CELEBRATION ======
      function checkSectionCompletion(section) {
        const { completed, total } = getSectionProgress(section);
        if (total > 0 && completed >= total && !completedSections[section]) {
          // Ø£ÙˆÙ„ Ù…Ø±Ø© ÙŠÙƒØªÙ…Ù„
          completedSections[section] = true;
          localStorage.setItem(
            `${userKey}_completedSections`,
            JSON.stringify(completedSections)
          );
          celebrate(section);
        }
      }

      function celebrate(section) {
        showBanner(`ğŸ† Ø¨Ø±Ø§ÙÙˆÙˆ ÙŠØ§ ${username}! Ø®Ù„ØµØª Ù…Ø­ÙˆØ± "${section}" ÙƒØ§Ù…Ù„!`);
        playApplause();
        launchConfetti(120, 5000);
      }

      // Banner
      function showBanner(text) {
        const b = document.getElementById("celebrateBanner");
        b.textContent = text;
        b.classList.add("show");
        setTimeout(() => {
          b.classList.remove("show");
        }, 5000);
      }

      // Simple applause via Web Audio
      function playApplause() {
        try {
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const o = ctx.createOscillator();
          const g = ctx.createGain();
          o.type = "triangle";
          o.frequency.value = 440;
          o.connect(g);
          g.connect(ctx.destination);
          g.gain.setValueAtTime(0.0001, ctx.currentTime);
          g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.05);
          g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.35);
          o.start();
          o.stop(ctx.currentTime + 0.4);

          // Ø·Ø¨Ù‚Ø© ØªØ§Ù†ÙŠØ©
          const o2 = ctx.createOscillator();
          const g2 = ctx.createGain();
          o2.type = "square";
          o2.frequency.value = 660;
          o2.connect(g2);
          g2.connect(ctx.destination);
          g2.gain.setValueAtTime(0.0001, ctx.currentTime);
          g2.gain.exponentialRampToValueAtTime(0.15, ctx.currentTime + 0.05);
          g2.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.35);
          o2.start();
          o2.stop(ctx.currentTime + 0.4);
        } catch (e) {}
      }

      // Confetti (emoji)
      function launchConfetti(count = 100, duration = 4000) {
        const emojis = ["ğŸ‰", "ğŸˆ", "âœ¨", "ğŸŠ", "â­"];
        const W = window.innerWidth;
        for (let i = 0; i < count; i++) {
          const span = document.createElement("span");
          span.className = "confetti";
          span.textContent = emojis[Math.floor(Math.random() * emojis.length)];
          span.style.left = Math.random() * W + "px";
          span.style.animationDuration = 2 + Math.random() * 3 + "s";
          span.style.transform = `translateY(-10px) rotate(${
            Math.random() * 360
          }deg)`;
          document.body.appendChild(span);
          setTimeout(() => span.remove(), duration);
        }
      }

      // ====== ADMIN OPTIONAL ======
      const addModel = () => {
        const section = document.getElementById("module-select").value;
        const data = moduleData[section];
        if (data.type === "models") data.count++;
        else if (data.type === "list")
          data.items.push({
            title: `Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ ${data.items.length + 1}`,
            url: "",
          });
        generateModules(section);
        updateProgressBar();
      };

      const confirmRemoveModel = () => {
        const section = document.getElementById("module-select").value;
        const data = moduleData[section];
        if (data.type === "models" && data.count > 1) {
          if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø­Ø°Ù Ø¢Ø®Ø± Ù†Ù…ÙˆØ°Ø¬ Ù…Ù† Ù‚Ø³Ù… ${section}ØŸ`))
            data.count--;
        } else if (data.type === "list" && data.items.length > 1) {
          if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø­Ø°Ù Ø¢Ø®Ø± Ø¹Ù†ØµØ± Ù…Ù† Ù‚Ø³Ù… ${section}ØŸ`))
            data.items.pop();
        } else {
          alert("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±!");
        }
        generateModules(section);
        updateProgressBar();
      };
    </script>
  </body>
</html>
